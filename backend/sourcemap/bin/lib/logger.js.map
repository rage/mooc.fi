{"version":3,"file":"logger.js","sourceRoot":"","sources":["../../../bin/lib/logger.ts"],"names":[],"mappings":";;;AAAA,kFAA8C;AAC9C,4DAA6B;AAC7B,gDAA8C;AAM9C,SAAwB,MAAM,CAAC,EAA0B;QAAxB,OAAO,aAAA;IACtC,IAAM,UAAU,GAAwB,CAAC,IAAI,oBAAO,CAAC,UAAU,CAAC,OAAO,EAAE,CAAC,CAAA;IAE1E,IAAI,OAAO,CAAC,GAAG,CAAC,QAAQ,KAAK,YAAY,EAAE;QACzC,UAAU,CAAC,IAAI,CACb,IAAI,+BAAa,CAAC;YAChB,IAAI,EAAE;gBACJ,OAAO,SAAA;aACR;YACD,KAAK,EAAE,OAAO;YACd,YAAY,EAAE,eAAM;YACpB,mBAAmB,EAAE,IAAI;YACzB,WAAW,EAAE,CAAC,eAAe,EAAE,OAAO,CAAC;SACxC,CAAC,CACH,CAAA;KACF;IAED,OAAO,oBAAO,CAAC,YAAY,CAAC;QAC1B,KAAK,EAAE,MAAM;QACb,MAAM,EAAE,oBAAO,CAAC,MAAM,CAAC,OAAO,CAC5B,oBAAO,CAAC,MAAM,CAAC,SAAS,EAAE,EAC1B,oBAAO,CAAC,MAAM,CAAC,IAAI,EAAE,CACtB;QACD,WAAW,EAAE,EAAE,OAAO,SAAA,EAAE;QACxB,UAAU,YAAA;KACX,CAAC,CAAA;AACJ,CAAC;AA1BD,4BA0BC","sourcesContent":["import WinstonSentry from \"winston-sentry-log\"\nimport winston from \"winston\"\nimport { Sentry } from \"../../services/sentry\"\n\ninterface LoggerOptions {\n  service: string\n}\n\nexport default function logger({ service }: LoggerOptions) {\n  const transports: winston.transport[] = [new winston.transports.Console()]\n\n  if (process.env.NODE_ENV === \"production\") {\n    transports.push(\n      new WinstonSentry({\n        tags: {\n          service,\n        },\n        level: \"error\",\n        sentryClient: Sentry,\n        isClientInitialized: true,\n        fingerprint: [\"{{ default }}\", service],\n      }),\n    )\n  }\n\n  return winston.createLogger({\n    level: \"info\",\n    format: winston.format.combine(\n      winston.format.timestamp(),\n      winston.format.json(),\n    ),\n    defaultMeta: { service },\n    transports,\n  })\n}\n"]}