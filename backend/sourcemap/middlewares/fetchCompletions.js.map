{"version":3,"file":"fetchCompletions.js","sourceRoot":"","sources":["../../middlewares/fetchCompletions.ts"],"names":[],"mappings":";;;AACA,mDAAsD;AAEtD,SAA8B,gBAAgB,CAAC,IAAS,EAAE,GAAiB;;;;;;oBACjE,MAAM,GAAK,IAAI,OAAT,CAAS;oBACjB,SAAS,GAAG,IAAI,IAAI,EAAE,CAAC,OAAO,EAAE,CAAA;oBACzB,qBAAM,uBAAuB,CAAC,IAAI,EAAE,GAAG,CAAC,EAAA;;oBAA/C,IAAI,GAAG,SAAwC;oBACrD,OAAO,CAAC,GAAG,CAAC,eAAe,EAAE,MAAM,CAAC,CAAA;oBAC9B,QAAQ,GAAG,IAAI,IAAI,EAAE,CAAC,OAAO,EAAE,CAAA;oBACrC,OAAO,CAAC,GAAG,CAAC,MAAM,EAAE,QAAQ,GAAG,SAAS,EAAE,MAAM,CAAC,CAAA;oBACjD,sBAAO,IAAI,EAAA;;;;CACZ;AARD,sCAQC;AAWD,SAAe,uBAAuB,CACpC,EAAmE,EACnE,GAAiB;QADf,MAAM,YAAA,EAAE,KAAK,WAAA,EAAE,KAAK,WAAA,EAAE,IAAI,UAAA,EAAE,MAAM,YAAA,EAAE,IAAI,UAAA;;;;;wBAGrB,qBAAM,GAAG,CAAC,EAAE,CAAC,MAAM,CAAC,OAAO,CAAC,EAAE,KAAK,EAAE,EAAE,IAAI,EAAE,MAAM,EAAE,EAAE,CAAC,EAAA;;oBAAvE,YAAY,GAAG,SAAwD;oBAE7E,sBAAO,GAAG,CAAC,EAAE,CAAC,UAAU,CAAC,QAAQ,uCAC5B,gCAAiB,CAAC,EAAE,KAAK,OAAA,EAAE,KAAK,OAAA,EAAE,IAAI,MAAA,EAAE,MAAM,QAAA,EAAE,IAAI,MAAA,EAAE,CAAC,KAC1D,KAAK,EAAE,EAAE,MAAM,EAAE,EAAE,EAAE,EAAE,YAAY,aAAZ,YAAY,uBAAZ,YAAY,CAAE,EAAE,EAAE,EAAE,IAC3C,EAAA;;;;CACH","sourcesContent":["import { NexusContext } from \"/context\"\nimport { convertPagination } from \"/util/db-functions\"\n\nexport default async function fetchCompletions(args: any, ctx: NexusContext) {\n  const { course } = args\n  const startTime = new Date().getTime()\n  const data = await getCompletionDataFromDB(args, ctx)\n  console.log(\"FINISHED WITH\", course)\n  const stopTime = new Date().getTime()\n  console.log(\"used\", stopTime - startTime, \"time\")\n  return data\n}\n\ninterface CompletionOptionTypes {\n  course: string\n  first?: number\n  after?: string\n  last?: number\n  before?: string\n  skip?: number\n}\n\nasync function getCompletionDataFromDB(\n  { course, first, after, last, before, skip }: CompletionOptionTypes,\n  ctx: NexusContext,\n) {\n  const courseObject = await ctx.db.course.findOne({ where: { slug: course } })\n\n  return ctx.db.completion.findMany({\n    ...convertPagination({ first, after, last, before, skip }),\n    where: { course: { id: courseObject?.id } },\n  })\n}\n"]}