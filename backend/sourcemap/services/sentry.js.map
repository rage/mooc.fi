{"version":3,"file":"sentry.js","sourceRoot":"","sources":["../../services/sentry.ts"],"names":[],"mappings":";;;;AAAA,yDAA6B;AAE7B,OAAO,CAAC,aAAa,CAAC,CAAC,MAAM,CAAC;IAC5B,gBAAgB,EAAE,OAAO,CAAC,GAAG,CAAC,QAAQ,KAAK,YAAY;CACxD,CAAC,CAAA;AACF,2DAAsC;AAoC7B,wBAAM;AAnCf,qDAAoD;AACpD,iDAA4B;AAE5B,MAAM,CAAC,IAAI,CAAC;IACV,GAAG,EAAE,OAAO,CAAC,GAAG,CAAC,UAAU;IAC3B,OAAO,EAAE,oBAAkB,OAAO,CAAC,GAAG,CAAC,UAAY;IACnD,gBAAgB,YAAC,UAAU,EAAE,KAAK;;QAChC,IAAI,UAAU,CAAC,IAAI,KAAK,MAAM,EAAE;YAC9B,IACE,aAAC,UAAU,CAAC,IAAI,0CAAE,GAAG,mCAAI,EAAE,CAAC,CAAC,QAAQ,CAAC,6BAA6B,CAAC,EACpE;gBACA,OAAO,IAAI,CAAA;aACZ;SACF;QAED,OAAO,UAAU,CAAA;IACnB,CAAC;IACD,YAAY,EAAE;QACZ,IAAI,4BAAa,CAAC;YAChB,IAAI,EAAE,iBAAO;YACb,QAAQ,EAAE,UAAC,KAAK;gBACd,IAAI,EAAC,KAAK,aAAL,KAAK,uBAAL,KAAK,CAAE,QAAQ,CAAA;oBAAE,OAAO,KAAK,CAAA;gBAElC,IAAM,QAAQ,GAAG,IAAI,CAAC,QAAQ,CAAC,KAAK,CAAC,QAAQ,CAAC,CAAA;gBAC9C,IAAM,OAAO,GAAG,IAAI,CAAC,OAAO,CAAC,KAAK,CAAC,QAAQ,CAAC,CAAA;gBAC5C,IAAM,YAAY,GAAG,IAAI,CAAC,QAAQ,CAAC,iBAAO,EAAE,OAAO,CAAC,CAAA;gBAEpD,KAAK,CAAC,QAAQ,GAAG,YAAU,YAAY,SAAI,QAAU,CAAA;gBAErD,OAAO,KAAK,CAAA;YACd,CAAC;SACF,CAAC;KACH;CACF,CAAC,CAAA","sourcesContent":["import rootdir from \"../root\"\n\nrequire(\"dotenv-safe\").config({\n  allowEmptyValues: process.env.NODE_ENV === \"production\",\n})\nimport * as Sentry from \"@sentry/node\"\nimport { RewriteFrames } from \"@sentry/integrations\"\nimport * as path from \"path\"\n\nSentry.init({\n  dsn: process.env.SENTRY_DSN,\n  release: `moocfi-backend@${process.env.GIT_COMMIT}`,\n  beforeBreadcrumb(breadcrumb, _hint) {\n    if (breadcrumb.type === \"http\") {\n      if (\n        (breadcrumb.data?.url ?? \"\").includes(\"newrelic.com/agent_listener\")\n      ) {\n        return null\n      }\n    }\n\n    return breadcrumb\n  },\n  integrations: [\n    new RewriteFrames({\n      root: rootdir,\n      iteratee: (frame) => {\n        if (!frame?.filename) return frame\n\n        const filename = path.basename(frame.filename)\n        const fileDir = path.dirname(frame.filename)\n        const relativePath = path.relative(rootdir, fileDir)\n\n        frame.filename = `app:///${relativePath}/${filename}`\n\n        return frame\n      },\n    }),\n  ],\n})\n\nexport { Sentry }\n"]}